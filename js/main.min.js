"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}var formElement=document.querySelector(".form"),passwordInput=document.querySelector(".form__input_type_password"),passwordMask=document.querySelector(".form__password-mask"),maskElement='<span class="form__password-star"></span>',maskElementSelector=".form__password-star",configObject={inputSelector:".form__input",submitButtonSelector:".form__submit",disabledButtonClass:"form__submit_disabled",validInputClass:"form__input_is-valid_true",invalidInputClass:"form__input_is-valid_false"},maskPhone=function(){window.addEventListener("DOMContentLoaded",function(){document.querySelector(".form__input_type_phone").setAttribute("pattern","[0-9][ -].[ -][0-9]{3}[ -].[ -][0-9]{3}[ -][0-9]{2}[ -][0-9]{2}"),document.querySelector(".form__input_type_phone").setAttribute("maxlength",19),[].forEach.call(document.querySelectorAll(".form__input_type_phone"),function(t){function e(t){var e=t.code;this.selectionStart<5&&t.preventDefault();var n="8 ( ___ ) ___-__-__",s=0,a=n.replace(/\D/g,""),o=this.value.replace(/\D/g,""),t=n.replace(/[_\d]/g,function(t){return s<o.length?o.charAt(s++)||a.charAt(s):t});-1!=(s=t.indexOf("_"))&&(s<8&&(s=4),t=t.slice(0,s),this.selectionStart=t.length+s);n=n.substr(0,this.value.length).replace(/_/g,function(t){return"\\d{1,"+t.length+"}"}).replace(/[()]/g,"\\$&");(!(n=new RegExp("^"+n+"$")).test(this.value)||this.value.length<5||47<e&&e<58)&&(this.value=t)}t.addEventListener("input",e),t.addEventListener("focus",e)})})},maskPassword=function(t,n,e,s){document.querySelector(".form__input_type_password").style.color="transparent",t.addEventListener("keydown",function(t){var e=Array.from(n.querySelectorAll(s));"Backspace"===t.key&&void 0!==e[e.length-1]&&e[e.length-1].remove()}),t.addEventListener("keypress",function(t){"Enter"!==t.key&&n.insertAdjacentHTML("beforeend",e)})},Form=function(){function n(t){var e=t.formElement,t=t.handleSubmitButton;_classCallCheck(this,n),this._form=e,this._backButton=this._form.querySelector(".form__back-button"),this._handleSubmitButton=t}return _createClass(n,[{key:"_getInputValues",value:function(){var e=this;return this._inputList=this._form.querySelectorAll(".form__input"),this._formValues={},this._inputList.forEach(function(t){e._formValues[t.name]=t.value}),this._formValues}},{key:"setEventListeners",value:function(){var e=this;this._form.addEventListener("submit",function(t){t.preventDefault(),e._handleSubmitButton(e._getInputValues())})}}]),n}(),FormValidator=function(){function n(t){var e=t.formElement,t=t.configObject;_classCallCheck(this,n),this._form=e,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._disabledButtonClass=t.disabledButtonClass,this._validInputClass=t.validInputClass,this._invalidInputClass=t.invalidInputClass}return _createClass(n,[{key:"_hasInvalidInput",value:function(t){return t.some(function(t){return!t.validity.valid})}},{key:"_isValid",value:function(t){t.classList.contains("form__input_type_password")||(t.validity.valid?(t.classList.remove(this._invalidInputClass),t.classList.add(this._validInputClass)):(t.classList.remove(this._validInputClass),t.classList.add(this._invalidInputClass)))}},{key:"_toggleButtonState",value:function(t,e){this._hasInvalidInput(t)?(e.classList.add(this._disabledButtonClass),e.setAttribute("disabled",!0)):(e.classList.remove(this._disabledButtonClass),e.removeAttribute("disabled",!0))}},{key:"enableValidation",value:function(){var e=this,n=Array.from(this._form.querySelectorAll(this._inputSelector)),s=this._form.querySelector(this._submitButtonSelector);this._toggleButtonState(n,s),n.forEach(function(t){t.addEventListener("input",function(){e._isValid(t),e._toggleButtonState(n,s)})})}}]),n}();maskPhone(),maskPassword(passwordInput,passwordMask,maskElement,maskElementSelector);var formValidator=new FormValidator({formElement:formElement,configObject:configObject});formValidator.enableValidation(),formElement.setAttribute("novalidate",!0);var form=new Form({formElement:formElement,handleSubmitButton:function(t){t.phone=t.phone.match(/\d/g).join("");var e=t.phone,t=t.password;fetch("https://example.com/auth",{method:"POST",headers:{authorization:"".concat(e," ").concat(t),"Content-Type":"application/json"}}).then(function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}).catch(function(t){console.log(t)})}});form.setEventListeners();
//# sourceMappingURL=../maps/main.min.js.map
